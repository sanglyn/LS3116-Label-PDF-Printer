<!-- Ver 0.4 -->

<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>LS-3116 라벨 PDF 생성기</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- pdf-lib CDN -->
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
  <script defer src="script.js"></script>
</head>
<body>
  <div class="app-shell">
    <!-- 헤더 -->
    <header class="app-header">
    <div class="app-title">

      <!-- 로고 / 버전 박스 -->
      <div class="app-logo">
        <span class="logo-box">
          Label PDF Printer <span class="app-version">v0.4</span>
        </span>
      </div>

      <!-- 서브 타이틀 (logo-box 바깥) -->
      <div class="app-subtitle">Formtec LS-3116 A4 Portrait Label Layout</div>

    </div>

    <div class="app-header-actions">
      <button id="helpBtn" type="button" class="icon-button" title="도움말">?</button>
    </div>
  </header>


    <!-- 메인 콘텐츠 -->
    <main class="app-main">
      <!-- 1. 업로드 & 파일 관리 -->
      <section class="card">
        <div class="card-header">
          <h1>1. PDF 업로드</h1>
          <span class="card-caption">LS-3116 라벨에 배치할 PDF를 추가하세요. (업로드 개수 제한 없음)</span>
        </div>

        <div id="dropZone" class="drop-zone">
          <div class="drop-zone-inner">
            <div class="drop-zone-icon">📄</div>
            <div class="drop-zone-text-main">PDF를 드래그하거나 클릭해서 업로드</div>
            <div class="drop-zone-text-sub">배송 라벨, 인보이스 등 필요한 PDF를 자유롭게 추가할 수 있습니다.</div>
          </div>
        </div>
        <input
          id="pdfFiles"
          type="file"
          accept="application/pdf"
          multiple
          style="display:none;"
        />

        <div class="files-toolbar">
          <span class="files-info" id="filesInfoText">업로드된 파일이 없습니다.</span>
          <div class="files-toolbar-right">
            <button id="toggleFilesViewBtn" type="button" class="btn-text" style="display:none;">
              전체 목록 보기
            </button>
            <button id="clearAllBtn" type="button" class="btn-text">
              모두 삭제
            </button>
          </div>
        </div>

        <table id="filesTable" class="files-table" style="display:none;">
          <thead>
            <tr>
              <th style="width:40px;">#</th>
              <th>파일명</th>
              <th style="width:150px;">배정 위치</th>
              <th style="width:70px;">삭제</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>

      <!-- 2. 페이지 / 라벨 배치 -->
      <section class="card">
        <div class="card-header">
          <div>
            <h2>2. 라벨 배치</h2>
            <span class="card-caption">페이지별 2×3 레이아웃에 PDF를 배치합니다.</span>
          </div>
          <button id="layoutTipBtn" type="button" class="icon-button small" title="배치 팁">
            ?
          </button>
        </div>

        <!-- 페이지 스트립 네비게이터 -->
        <div class="layout-strip-header">
          <div class="layout-title-group">
            <div class="layout-title-main">LS-3116 페이지 보드</div>
            <div class="layout-title-sub">
              화면에 최대 4개의 페이지 보드를 보여줍니다. 각 칸에 PDF를 드래그해서 배치할 수 있어요.
            </div>
          </div>
          <div class="page-strip-nav">
            <button id="pageStripPrev" class="icon-button small" type="button" title="이전 페이지 그룹">
                ◀
            </button>
            <span id="pageStripRange" class="page-strip-range">1–1 / 1</span>
            <button id="pageStripNext" class="icon-button small" type="button" title="다음 페이지 그룹">
                ▶
            </button>
            </div>
        </div>

        <!-- 페이지 보드들 + 페이지 추가 버튼 -->
        <div class="page-strip-wrapper">
            <div id="pageStrip" class="page-strip"></div>

            <!-- 세련된 동그란 + 버튼 (페이지 보드 오른쪽, 세로 가운데 정렬) -->
            <button
                id="addPageBtn"
                class="page-add-button"
                type="button"
                title="페이지 추가"
            >
            +
            </button>
        </div>

<div id="selectedFileInfo" class="selected-file-label">
  선택된 파일: 없음 (페이지 보드에서 파일이 들어간 슬롯을 클릭해서 선택)
</div>

      </section>

      <!-- 3. 오프셋 설정 & PDF 생성 -->
      <section class="card">
        <div class="card-header">
          <h2>3. 오프셋 & PDF 생성</h2>
          <span class="card-caption">프리셋으로 기본값을 맞추고, 필요하면 세부 오프셋으로 미세 조정하세요.</span>
        </div>

        <div class="offset-row">
          <div class="offset-row-left">
            <label class="field-label">오프셋 프리셋</label>
            <select id="offsetPreset" class="select">
              <option value="tracx">트랙스로지스</option>
              <option value="shopee">쇼피SLS</option>
            </select>
          </div>
          <div class="offset-row-right">
            <button id="toggleOffsetDetails" type="button" class="btn-offset-toggle">
              세부 오프셋 (고급) 펼치기 ▾
            </button>
          </div>
        </div>

        <!-- 아코디언: 세부 오프셋 -->
        <div id="offsetDetails" class="offset-details" style="display:none;">
          <div class="offset-section">
            <div class="offset-section-title">전체 오프셋 (A4 기준, mm)</div>
            <div class="offset-section-grid">
              <div class="field">
                <label for="sheetOffsetX" class="field-label">전체 X (가로)</label>
                <input type="number" id="sheetOffsetX" class="input" step="0.1" value="0" />
                <span class="field-hint">+ 오른쪽 / - 왼쪽</span>
              </div>
              <div class="field">
                <label for="sheetOffsetY" class="field-label">전체 Y (세로)</label>
                <input type="number" id="sheetOffsetY" class="input" step="0.1" value="0" />
                <span class="field-hint">+ 위쪽 / - 아래쪽</span>
              </div>
              <div class="field field-full">
                <label class="checkbox-label">
                  <input type="checkbox" id="showGuide" unchecked />
                  <span>가이드 레이아웃 표시 (라벨 테두리)</span>
                </label>
              </div>
            </div>
          </div>

          <div class="offset-section">
            <div class="offset-section-title">칸 기본 오프셋 & 축소 (6칸 전체에 일괄 적용)</div>
            <div class="offset-section-grid">
              <div class="field">
                <label for="bulkSlotOffsetX" class="field-label">X (mm)</label>
                <input type="number" id="bulkSlotOffsetX" class="input" step="0.1" value="0" />
                <span class="field-hint">+ 오른쪽 / - 왼쪽</span>
              </div>
              <div class="field">
                <label for="bulkSlotOffsetY" class="field-label">Y (mm)</label>
                <input type="number" id="bulkSlotOffsetY" class="input" step="0.1" value="0" />
                <span class="field-hint">+ 위쪽 / - 아래쪽</span>
              </div>
              <div class="field">
                <label for="bulkSlotScale" class="field-label">축소 (%)</label>
                <input type="number" id="bulkSlotScale" class="input" step="1" value="95" />
                <span class="field-hint">권장: 50 ~ 120</span>
              </div>
              <div class="field field-full">
                <button type="button" id="applyBulkSlotOffsetBtn" class="btn-secondary small">
                  모든 칸에 X/Y/축소 적용
                </button>
              </div>
            </div>
          </div>

          <div class="offset-section">
            <div class="offset-section-title">칸별 오프셋 & 축소</div>
            <span class="card-caption"> (트랙스로지스) 복수 라벨 반영 - 오른쪽 라벨 왼쪽 이동 X: -100, 아래 라벨 위로 이동 Y: 95 </span>
            <div class="slot-offset-grid">
              <!-- 6칸 반복 -->
              <div class="slot-offset-item">
                <div class="slot-offset-title">칸 1</div>
                <div class="slot-offset-fields">
                  <label>X <input type="number" id="slotOffsetX0" class="input" step="0.1" value="0" /></label>
                  <label>Y <input type="number" id="slotOffsetY0" class="input" step="0.1" value="0" /></label>
                  <label>축소% <input type="number" id="slotScale0" class="input" step="1" value="95" /></label>
                </div>
              </div>

              <div class="slot-offset-item">
                <div class="slot-offset-title">칸 2</div>
                <div class="slot-offset-fields">
                  <label>X <input type="number" id="slotOffsetX1" class="input" step="0.1" value="0" /></label>
                  <label>Y <input type="number" id="slotOffsetY1" class="input" step="0.1" value="0" /></label>
                  <label>축소% <input type="number" id="slotScale1" class="input" step="1" value="95" /></label>
                </div>
              </div>

              <div class="slot-offset-item">
                <div class="slot-offset-title">칸 3</div>
                <div class="slot-offset-fields">
                  <label>X <input type="number" id="slotOffsetX2" class="input" step="0.1" value="0" /></label>
                  <label>Y <input type="number" id="slotOffsetY2" class="input" step="0.1" value="0" /></label>
                  <label>축소% <input type="number" id="slotScale2" class="input" step="1" value="95" /></label>
                </div>
              </div>

              <div class="slot-offset-item">
                <div class="slot-offset-title">칸 4</div>
                <div class="slot-offset-fields">
                  <label>X <input type="number" id="slotOffsetX3" class="input" step="0.1" value="0" /></label>
                  <label>Y <input type="number" id="slotOffsetY3" class="input" step="0.1" value="0" /></label>
                  <label>축소% <input type="number" id="slotScale3" class="input" step="1" value="95" /></label>
                </div>
              </div>

              <div class="slot-offset-item">
                <div class="slot-offset-title">칸 5</div>
                <div class="slot-offset-fields">
                  <label>X <input type="number" id="slotOffsetX4" class="input" step="0.1" value="0" /></label>
                  <label>Y <input type="number" id="slotOffsetY4" class="input" step="0.1" value="0" /></label>
                  <label>축소% <input type="number" id="slotScale4" class="input" step="1" value="95" /></label>
                </div>
              </div>

              <div class="slot-offset-item">
                <div class="slot-offset-title">칸 6</div>
                <div class="slot-offset-fields">
                  <label>X <input type="number" id="slotOffsetX5" class="input" step="0.1" value="0" /></label>
                  <label>Y <input type="number" id="slotOffsetY5" class="input" step="0.1" value="0" /></label>
                  <label>축소% <input type="number" id="slotScale5" class="input" step="1" value="95" /></label>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="generate-row">
          <button id="generateBtn" disabled class="btn-primary">
            PDF 생성
          </button>
          <a
            id="downloadLink"
            href="#"
            download="LS-3116-labeled.pdf"
            class="btn-outline"
            style="display:none;"
          >
            생성된 PDF 다운로드
          </a>
        </div>
        <div id="msg"></div>
      </section>

      <!-- 4. 미리보기 -->
      <section class="card">
        <div class="card-header">
          <h2>4. 미리보기</h2>
          <span class="card-caption">생성된 PDF를 A4 비율로 미리 확인하세요.</span>
        </div>
        <div class="preview-wrapper">
          <iframe id="pdfPreview" class="preview-frame"></iframe>
        </div>
      </section>
    </main>
  </div>

  <!-- 도움말 모달 (전체 + 배치 팁 포함) -->
  <div id="helpModal" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3>도움말 & 배치 팁</h3>
        <button id="helpClose" class="icon-button small">✕</button>
      </div>
      <div class="modal-body">
        <p>이 도구는 Formtec LS-3116 라벨 용지(2×3)에 PDF를 정확한 위치로 배치하기 위한 툴입니다.</p>
        <ul>
          <li>PDF를 업로드하면, 빈 칸부터 자동으로 순서대로 배정됩니다.</li>
          <li>각 페이지는 2×3 레이아웃이며, 한 화면에 최대 4페이지의 보드가 표시됩니다.</li>
          <li>칸을 드래그 & 드랍해서 같은 페이지 또는 현재 화면에 보이는 다른 페이지의 칸으로 이동 / 교환할 수 있습니다.</li>
          <li>페이지 보드에서 파일이 들어간 칸을 클릭해 선택한 뒤, 빈 칸을 클릭하거나 드래그 &amp; 드랍으로 다른 칸으로 이동/교환할 수 있습니다. (채워진 칸끼리의 교환은 드래그 &amp; 드랍으로만 가능합니다.)</li>
          <li>+ 페이지 버튼으로 새 페이지를 추가할 수 있습니다.</li>
          <li>오프셋 프리셋(트랙스로지스 / 쇼피SLS)을 사용한 뒤, 세부 오프셋 (고급)에서 칸별 위치·축소를 미세 조정하세요.</li>
        </ul>
      </div>
    </div>
  </div>
</body>
</html>
